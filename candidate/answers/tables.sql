DROP TABLE #dim_date
CREATE TABLE #dim_date (date_key DATE
						,year_day VARCHAR(50)
						,year_week VARCHAR(50)
						,year_month VARCHAR(50)
						,year_quarter VARCHAR(50)
						,day_of_month_no INT
						,is_week_day INT
						,day_name_full VARCHAR(50)
						,day_name_short VARCHAR(50)
						,month_name_full VARCHAR(50)
						,month_name_short VARCHAR(50)
						,month_no INT
						,week_no INT
						,quarter_no INT
						,year_no INT
						,century_no INT
						,first_day_of_week DATE
						,first_day_of_month DATE
						,first_day_of_quarter DATE
						,first_day_of_year DATE
						,last_day_of_week DATE
						,last_day_of_month DATE
						,last_day_of_quarter DATE
						,last_day_of_year DATE
						,last_working_day_of_month DATE
						,last_working_day_of_quarter DATE
						,last_working_day_of_year DATE
						,most_recent_working_day DATE
						,day_of_week_no INT
						,day_of_quarter_no INT
						,day_of_year_no INT
						,year_no_cumulative INT
						,quarter_no_cumulative INT
						,month_no_cumulative INT
						,week_no_cumulative INT
						,day_no_cumulative INT
						,lunar_uk_is_full_moon INT
						,lunar_uk_is_total_eclipse INT
						,lunar_uk_is_partial_eclipse INT
						,is_uk_holiday INT
						,uk_holiday_name VARCHAR(50)
						,meta_process_time VARCHAR(50)
						);

INSERT INTO #dim_date (date_key,year_day,year_week,year_month,year_quarter,day_of_month_no,is_week_day,day_name_full,day_name_short,month_name_full,month_name_short,month_no,week_no,quarter_no,year_no,century_no,first_day_of_week,first_day_of_month,first_day_of_quarter,first_day_of_year,last_day_of_week,last_day_of_month,last_day_of_quarter,last_day_of_year,last_working_day_of_month,last_working_day_of_quarter,last_working_day_of_year,most_recent_working_day,day_of_week_no,day_of_quarter_no,day_of_year_no,year_no_cumulative,quarter_no_cumulative,month_no_cumulative,week_no_cumulative,day_no_cumulative,lunar_uk_is_full_moon,lunar_uk_is_total_eclipse,lunar_uk_is_partial_eclipse,is_uk_holiday,uk_holiday_name,meta_process_time) VALUES 
 ('2021-12-01','2021D335','2021W48','2021M12','2021Q4','1','1','Wednesday','Wed','December','Dec','12','48','4','2021','20','2021-11-29','2021-12-01','2021-10-01','2021-10-01','2021-12-05','2021-12-31','2021-12-31','2021-12-31','2021-12-31','2021-12-31','2021-12-31','2021-12-01','3','62','335','121','487','1463','6361','44529','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2021-12-02','2021D336','2021W48','2021M12','2021Q4','2','1','Thursday','Thu','December','Dec','12','48','4','2021','20','2021-11-29','2021-12-01','2021-10-01','2021-10-01','2021-12-05','2021-12-31','2021-12-31','2021-12-31','2021-12-31','2021-12-31','2021-12-31','2021-12-02','4','63','336','121','487','1463','6361','44530','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2021-12-03','2021D337','2021W48','2021M12','2021Q4','3','1','Friday','Fri','December','Dec','12','48','4','2021','20','2021-11-29','2021-12-01','2021-10-01','2021-10-01','2021-12-05','2021-12-31','2021-12-31','2021-12-31','2021-12-31','2021-12-31','2021-12-31','2021-12-03','5','64','337','121','487','1463','6361','44531','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2021-12-04','2021D338','2021W48','2021M12','2021Q4','4','0','Saturday','Sat','December','Dec','12','48','4','2021','20','2021-11-29','2021-12-01','2021-10-01','2021-10-01','2021-12-05','2021-12-31','2021-12-31','2021-12-31','2021-12-31','2021-12-31','2021-12-31','2021-12-03','6','65','338','121','487','1463','6361','44532','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2021-12-05','2021D339','2021W48','2021M12','2021Q4','5','0','Sunday','Sun','December','Dec','12','48','4','2021','20','2021-11-29','2021-12-01','2021-10-01','2021-10-01','2021-12-05','2021-12-31','2021-12-31','2021-12-31','2021-12-31','2021-12-31','2021-12-31','2021-12-03','7','66','339','121','487','1463','6361','44533','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2021-12-06','2021D340','2021W49','2021M12','2021Q4','6','1','Monday','Mon','December','Dec','12','49','4','2021','20','2021-12-06','2021-12-01','2021-10-01','2021-10-01','2021-12-12','2021-12-31','2021-12-31','2021-12-31','2021-12-31','2021-12-31','2021-12-31','2021-12-06','1','67','340','121','487','1463','6362','44534','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2021-12-07','2021D341','2021W49','2021M12','2021Q4','7','1','Tuesday','Tue','December','Dec','12','49','4','2021','20','2021-12-06','2021-12-01','2021-10-01','2021-10-01','2021-12-12','2021-12-31','2021-12-31','2021-12-31','2021-12-31','2021-12-31','2021-12-31','2021-12-07','2','68','341','121','487','1463','6362','44535','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2021-12-08','2021D342','2021W49','2021M12','2021Q4','8','1','Wednesday','Wed','December','Dec','12','49','4','2021','20','2021-12-06','2021-12-01','2021-10-01','2021-10-01','2021-12-12','2021-12-31','2021-12-31','2021-12-31','2021-12-31','2021-12-31','2021-12-31','2021-12-08','3','69','342','121','487','1463','6362','44536','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2021-12-09','2021D343','2021W49','2021M12','2021Q4','9','1','Thursday','Thu','December','Dec','12','49','4','2021','20','2021-12-06','2021-12-01','2021-10-01','2021-10-01','2021-12-12','2021-12-31','2021-12-31','2021-12-31','2021-12-31','2021-12-31','2021-12-31','2021-12-09','4','70','343','121','487','1463','6362','44537','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2021-12-10','2021D344','2021W49','2021M12','2021Q4','10','1','Friday','Fri','December','Dec','12','49','4','2021','20','2021-12-06','2021-12-01','2021-10-01','2021-10-01','2021-12-12','2021-12-31','2021-12-31','2021-12-31','2021-12-31','2021-12-31','2021-12-31','2021-12-10','5','71','344','121','487','1463','6362','44538','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2021-12-11','2021D345','2021W49','2021M12','2021Q4','11','0','Saturday','Sat','December','Dec','12','49','4','2021','20','2021-12-06','2021-12-01','2021-10-01','2021-10-01','2021-12-12','2021-12-31','2021-12-31','2021-12-31','2021-12-31','2021-12-31','2021-12-31','2021-12-10','6','72','345','121','487','1463','6362','44539','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2021-12-12','2021D346','2021W49','2021M12','2021Q4','12','0','Sunday','Sun','December','Dec','12','49','4','2021','20','2021-12-06','2021-12-01','2021-10-01','2021-10-01','2021-12-12','2021-12-31','2021-12-31','2021-12-31','2021-12-31','2021-12-31','2021-12-31','2021-12-10','7','73','346','121','487','1463','6362','44540','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2021-12-13','2021D347','2021W50','2021M12','2021Q4','13','1','Monday','Mon','December','Dec','12','50','4','2021','20','2021-12-13','2021-12-01','2021-10-01','2021-10-01','2021-12-19','2021-12-31','2021-12-31','2021-12-31','2021-12-31','2021-12-31','2021-12-31','2021-12-13','1','74','347','121','487','1463','6363','44541','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2021-12-14','2021D348','2021W50','2021M12','2021Q4','14','1','Tuesday','Tue','December','Dec','12','50','4','2021','20','2021-12-13','2021-12-01','2021-10-01','2021-10-01','2021-12-19','2021-12-31','2021-12-31','2021-12-31','2021-12-31','2021-12-31','2021-12-31','2021-12-14','2','75','348','121','487','1463','6363','44542','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2021-12-15','2021D349','2021W50','2021M12','2021Q4','15','1','Wednesday','Wed','December','Dec','12','50','4','2021','20','2021-12-13','2021-12-01','2021-10-01','2021-10-01','2021-12-19','2021-12-31','2021-12-31','2021-12-31','2021-12-31','2021-12-31','2021-12-31','2021-12-15','3','76','349','121','487','1463','6363','44543','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2021-12-16','2021D350','2021W50','2021M12','2021Q4','16','1','Thursday','Thu','December','Dec','12','50','4','2021','20','2021-12-13','2021-12-01','2021-10-01','2021-10-01','2021-12-19','2021-12-31','2021-12-31','2021-12-31','2021-12-31','2021-12-31','2021-12-31','2021-12-16','4','77','350','121','487','1463','6363','44544','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2021-12-17','2021D351','2021W50','2021M12','2021Q4','17','1','Friday','Fri','December','Dec','12','50','4','2021','20','2021-12-13','2021-12-01','2021-10-01','2021-10-01','2021-12-19','2021-12-31','2021-12-31','2021-12-31','2021-12-31','2021-12-31','2021-12-31','2021-12-17','5','78','351','121','487','1463','6363','44545','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2021-12-18','2021D352','2021W50','2021M12','2021Q4','18','0','Saturday','Sat','December','Dec','12','50','4','2021','20','2021-12-13','2021-12-01','2021-10-01','2021-10-01','2021-12-19','2021-12-31','2021-12-31','2021-12-31','2021-12-31','2021-12-31','2021-12-31','2021-12-17','6','79','352','121','487','1463','6363','44546','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2021-12-19','2021D353','2021W50','2021M12','2021Q4','19','0','Sunday','Sun','December','Dec','12','50','4','2021','20','2021-12-13','2021-12-01','2021-10-01','2021-10-01','2021-12-19','2021-12-31','2021-12-31','2021-12-31','2021-12-31','2021-12-31','2021-12-31','2021-12-17','7','80','353','121','487','1463','6363','44547','1','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2021-12-20','2021D354','2021W51','2021M12','2021Q4','20','1','Monday','Mon','December','Dec','12','51','4','2021','20','2021-12-20','2021-12-01','2021-10-01','2021-10-01','2021-12-26','2021-12-31','2021-12-31','2021-12-31','2021-12-31','2021-12-31','2021-12-31','2021-12-20','1','81','354','121','487','1463','6364','44548','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2021-12-21','2021D355','2021W51','2021M12','2021Q4','21','1','Tuesday','Tue','December','Dec','12','51','4','2021','20','2021-12-20','2021-12-01','2021-10-01','2021-10-01','2021-12-26','2021-12-31','2021-12-31','2021-12-31','2021-12-31','2021-12-31','2021-12-31','2021-12-21','2','82','355','121','487','1463','6364','44549','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2021-12-22','2021D356','2021W51','2021M12','2021Q4','22','1','Wednesday','Wed','December','Dec','12','51','4','2021','20','2021-12-20','2021-12-01','2021-10-01','2021-10-01','2021-12-26','2021-12-31','2021-12-31','2021-12-31','2021-12-31','2021-12-31','2021-12-31','2021-12-22','3','83','356','121','487','1463','6364','44550','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2021-12-23','2021D357','2021W51','2021M12','2021Q4','23','1','Thursday','Thu','December','Dec','12','51','4','2021','20','2021-12-20','2021-12-01','2021-10-01','2021-10-01','2021-12-26','2021-12-31','2021-12-31','2021-12-31','2021-12-31','2021-12-31','2021-12-31','2021-12-23','4','84','357','121','487','1463','6364','44551','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2021-12-24','2021D358','2021W51','2021M12','2021Q4','24','1','Friday','Fri','December','Dec','12','51','4','2021','20','2021-12-20','2021-12-01','2021-10-01','2021-10-01','2021-12-26','2021-12-31','2021-12-31','2021-12-31','2021-12-31','2021-12-31','2021-12-31','2021-12-24','5','85','358','121','487','1463','6364','44552','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2021-12-25','2021D359','2021W51','2021M12','2021Q4','25','0','Saturday','Sat','December','Dec','12','51','4','2021','20','2021-12-20','2021-12-01','2021-10-01','2021-10-01','2021-12-26','2021-12-31','2021-12-31','2021-12-31','2021-12-31','2021-12-31','2021-12-31','2021-12-24','6','86','359','121','487','1463','6364','44553','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2021-12-26','2021D360','2021W51','2021M12','2021Q4','26','0','Sunday','Sun','December','Dec','12','51','4','2021','20','2021-12-20','2021-12-01','2021-10-01','2021-10-01','2021-12-26','2021-12-31','2021-12-31','2021-12-31','2021-12-31','2021-12-31','2021-12-31','2021-12-24','7','87','360','121','487','1463','6364','44554','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2021-12-27','2021D361','2021W52','2021M12','2021Q4','27','1','Monday','Mon','December','Dec','12','52','4','2021','20','2021-12-27','2021-12-01','2021-10-01','2021-10-01','2022-01-02','2021-12-31','2021-12-31','2021-12-31','2021-12-31','2021-12-31','2021-12-31','2021-12-24','1','88','361','121','487','1463','6365','44555','0','0','0','1','Christmas Day','2022-08-29 09:01:26.503255 UTC'), 
 ('2021-12-28','2021D362','2021W52','2021M12','2021Q4','28','1','Tuesday','Tue','December','Dec','12','52','4','2021','20','2021-12-27','2021-12-01','2021-10-01','2021-10-01','2022-01-02','2021-12-31','2021-12-31','2021-12-31','2021-12-31','2021-12-31','2021-12-31','2021-12-24','2','89','362','121','487','1463','6365','44556','0','0','0','1','Boxing Day','2022-08-29 09:01:26.503255 UTC'), 
 ('2021-12-29','2021D363','2021W52','2021M12','2021Q4','29','1','Wednesday','Wed','December','Dec','12','52','4','2021','20','2021-12-27','2021-12-01','2021-10-01','2021-10-01','2022-01-02','2021-12-31','2021-12-31','2021-12-31','2021-12-31','2021-12-31','2021-12-31','2021-12-29','3','90','363','121','487','1463','6365','44557','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2021-12-30','2021D364','2021W52','2021M12','2021Q4','30','1','Thursday','Thu','December','Dec','12','52','4','2021','20','2021-12-27','2021-12-01','2021-10-01','2021-10-01','2022-01-02','2021-12-31','2021-12-31','2021-12-31','2021-12-31','2021-12-31','2021-12-31','2021-12-30','4','91','364','121','487','1463','6365','44558','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2021-12-31','2021D365','2021W52','2021M12','2021Q4','31','1','Friday','Fri','December','Dec','12','52','4','2021','20','2021-12-27','2021-12-01','2021-10-01','2021-10-01','2022-01-02','2021-12-31','2021-12-31','2021-12-31','2021-12-31','2021-12-31','2021-12-31','2021-12-31','5','92','365','121','487','1463','6365','44559','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2022-01-01','2022D1','2022W00','2022M01','2022Q1','1','0','Saturday','Sat','January','Jan','1','0','1','2022','20','2021-12-27','2022-01-01','2022-01-01','2022-01-01','2022-01-02','2022-01-31','2022-03-31','2022-12-31','2022-01-31','2022-03-31','2022-12-30','2021-12-31','6','1','1','122','488','1464','6365','44560','0','0','0','1','New Years Day','2022-08-29 09:01:26.503255 UTC'), 
 ('2022-01-02','2022D2','2022W00','2022M01','2022Q1','2','0','Sunday','Sun','January','Jan','1','0','1','2022','20','2021-12-27','2022-01-01','2022-01-01','2022-01-01','2022-01-02','2022-01-31','2022-03-31','2022-12-31','2022-01-31','2022-03-31','2022-12-30','2021-12-31','7','2','2','122','488','1464','6365','44561','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2022-01-03','2022D3','2022W01','2022M01','2022Q1','3','1','Monday','Mon','January','Jan','1','1','1','2022','20','2022-01-03','2022-01-01','2022-01-01','2022-01-01','2022-01-09','2022-01-31','2022-03-31','2022-12-31','2022-01-31','2022-03-31','2022-12-30','2022-01-03','1','3','3','122','488','1464','6366','44562','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2022-01-04','2022D4','2022W01','2022M01','2022Q1','4','1','Tuesday','Tue','January','Jan','1','1','1','2022','20','2022-01-03','2022-01-01','2022-01-01','2022-01-01','2022-01-09','2022-01-31','2022-03-31','2022-12-31','2022-01-31','2022-03-31','2022-12-30','2022-01-04','2','4','4','122','488','1464','6366','44563','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2022-01-05','2022D5','2022W01','2022M01','2022Q1','5','1','Wednesday','Wed','January','Jan','1','1','1','2022','20','2022-01-03','2022-01-01','2022-01-01','2022-01-01','2022-01-09','2022-01-31','2022-03-31','2022-12-31','2022-01-31','2022-03-31','2022-12-30','2022-01-05','3','5','5','122','488','1464','6366','44564','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2022-01-06','2022D6','2022W01','2022M01','2022Q1','6','1','Thursday','Thu','January','Jan','1','1','1','2022','20','2022-01-03','2022-01-01','2022-01-01','2022-01-01','2022-01-09','2022-01-31','2022-03-31','2022-12-31','2022-01-31','2022-03-31','2022-12-30','2022-01-06','4','6','6','122','488','1464','6366','44565','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2022-01-07','2022D7','2022W01','2022M01','2022Q1','7','1','Friday','Fri','January','Jan','1','1','1','2022','20','2022-01-03','2022-01-01','2022-01-01','2022-01-01','2022-01-09','2022-01-31','2022-03-31','2022-12-31','2022-01-31','2022-03-31','2022-12-30','2022-01-07','5','7','7','122','488','1464','6366','44566','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2022-01-08','2022D8','2022W01','2022M01','2022Q1','8','0','Saturday','Sat','January','Jan','1','1','1','2022','20','2022-01-03','2022-01-01','2022-01-01','2022-01-01','2022-01-09','2022-01-31','2022-03-31','2022-12-31','2022-01-31','2022-03-31','2022-12-30','2022-01-07','6','8','8','122','488','1464','6366','44567','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2022-01-09','2022D9','2022W01','2022M01','2022Q1','9','0','Sunday','Sun','January','Jan','1','1','1','2022','20','2022-01-03','2022-01-01','2022-01-01','2022-01-01','2022-01-09','2022-01-31','2022-03-31','2022-12-31','2022-01-31','2022-03-31','2022-12-30','2022-01-07','7','9','9','122','488','1464','6366','44568','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2022-01-10','2022D10','2022W02','2022M01','2022Q1','10','1','Monday','Mon','January','Jan','1','2','1','2022','20','2022-01-10','2022-01-01','2022-01-01','2022-01-01','2022-01-16','2022-01-31','2022-03-31','2022-12-31','2022-01-31','2022-03-31','2022-12-30','2022-01-10','1','10','10','122','488','1464','6367','44569','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2022-01-11','2022D11','2022W02','2022M01','2022Q1','11','1','Tuesday','Tue','January','Jan','1','2','1','2022','20','2022-01-10','2022-01-01','2022-01-01','2022-01-01','2022-01-16','2022-01-31','2022-03-31','2022-12-31','2022-01-31','2022-03-31','2022-12-30','2022-01-11','2','11','11','122','488','1464','6367','44570','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2022-01-12','2022D12','2022W02','2022M01','2022Q1','12','1','Wednesday','Wed','January','Jan','1','2','1','2022','20','2022-01-10','2022-01-01','2022-01-01','2022-01-01','2022-01-16','2022-01-31','2022-03-31','2022-12-31','2022-01-31','2022-03-31','2022-12-30','2022-01-12','3','12','12','122','488','1464','6367','44571','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2022-01-13','2022D13','2022W02','2022M01','2022Q1','13','1','Thursday','Thu','January','Jan','1','2','1','2022','20','2022-01-10','2022-01-01','2022-01-01','2022-01-01','2022-01-16','2022-01-31','2022-03-31','2022-12-31','2022-01-31','2022-03-31','2022-12-30','2022-01-13','4','13','13','122','488','1464','6367','44572','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2022-01-14','2022D14','2022W02','2022M01','2022Q1','14','1','Friday','Fri','January','Jan','1','2','1','2022','20','2022-01-10','2022-01-01','2022-01-01','2022-01-01','2022-01-16','2022-01-31','2022-03-31','2022-12-31','2022-01-31','2022-03-31','2022-12-30','2022-01-14','5','14','14','122','488','1464','6367','44573','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2022-01-15','2022D15','2022W02','2022M01','2022Q1','15','0','Saturday','Sat','January','Jan','1','2','1','2022','20','2022-01-10','2022-01-01','2022-01-01','2022-01-01','2022-01-16','2022-01-31','2022-03-31','2022-12-31','2022-01-31','2022-03-31','2022-12-30','2022-01-14','6','15','15','122','488','1464','6367','44574','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2022-01-16','2022D16','2022W02','2022M01','2022Q1','16','0','Sunday','Sun','January','Jan','1','2','1','2022','20','2022-01-10','2022-01-01','2022-01-01','2022-01-01','2022-01-16','2022-01-31','2022-03-31','2022-12-31','2022-01-31','2022-03-31','2022-12-30','2022-01-14','7','16','16','122','488','1464','6367','44575','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2022-01-17','2022D17','2022W03','2022M01','2022Q1','17','1','Monday','Mon','January','Jan','1','3','1','2022','20','2022-01-17','2022-01-01','2022-01-01','2022-01-01','2022-01-23','2022-01-31','2022-03-31','2022-12-31','2022-01-31','2022-03-31','2022-12-30','2022-01-17','1','17','17','122','488','1464','6368','44576','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2022-01-18','2022D18','2022W03','2022M01','2022Q1','18','1','Tuesday','Tue','January','Jan','1','3','1','2022','20','2022-01-17','2022-01-01','2022-01-01','2022-01-01','2022-01-23','2022-01-31','2022-03-31','2022-12-31','2022-01-31','2022-03-31','2022-12-30','2022-01-18','2','18','18','122','488','1464','6368','44577','1','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2022-01-19','2022D19','2022W03','2022M01','2022Q1','19','1','Wednesday','Wed','January','Jan','1','3','1','2022','20','2022-01-17','2022-01-01','2022-01-01','2022-01-01','2022-01-23','2022-01-31','2022-03-31','2022-12-31','2022-01-31','2022-03-31','2022-12-30','2022-01-19','3','19','19','122','488','1464','6368','44578','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2022-01-20','2022D20','2022W03','2022M01','2022Q1','20','1','Thursday','Thu','January','Jan','1','3','1','2022','20','2022-01-17','2022-01-01','2022-01-01','2022-01-01','2022-01-23','2022-01-31','2022-03-31','2022-12-31','2022-01-31','2022-03-31','2022-12-30','2022-01-20','4','20','20','122','488','1464','6368','44579','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2022-01-21','2022D21','2022W03','2022M01','2022Q1','21','1','Friday','Fri','January','Jan','1','3','1','2022','20','2022-01-17','2022-01-01','2022-01-01','2022-01-01','2022-01-23','2022-01-31','2022-03-31','2022-12-31','2022-01-31','2022-03-31','2022-12-30','2022-01-21','5','21','21','122','488','1464','6368','44580','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2022-01-22','2022D22','2022W03','2022M01','2022Q1','22','0','Saturday','Sat','January','Jan','1','3','1','2022','20','2022-01-17','2022-01-01','2022-01-01','2022-01-01','2022-01-23','2022-01-31','2022-03-31','2022-12-31','2022-01-31','2022-03-31','2022-12-30','2022-01-21','6','22','22','122','488','1464','6368','44581','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2022-01-23','2022D23','2022W03','2022M01','2022Q1','23','0','Sunday','Sun','January','Jan','1','3','1','2022','20','2022-01-17','2022-01-01','2022-01-01','2022-01-01','2022-01-23','2022-01-31','2022-03-31','2022-12-31','2022-01-31','2022-03-31','2022-12-30','2022-01-21','7','23','23','122','488','1464','6368','44582','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2022-01-24','2022D24','2022W04','2022M01','2022Q1','24','1','Monday','Mon','January','Jan','1','4','1','2022','20','2022-01-24','2022-01-01','2022-01-01','2022-01-01','2022-01-30','2022-01-31','2022-03-31','2022-12-31','2022-01-31','2022-03-31','2022-12-30','2022-01-24','1','24','24','122','488','1464','6369','44583','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2022-01-25','2022D25','2022W04','2022M01','2022Q1','25','1','Tuesday','Tue','January','Jan','1','4','1','2022','20','2022-01-24','2022-01-01','2022-01-01','2022-01-01','2022-01-30','2022-01-31','2022-03-31','2022-12-31','2022-01-31','2022-03-31','2022-12-30','2022-01-25','2','25','25','122','488','1464','6369','44584','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2022-01-26','2022D26','2022W04','2022M01','2022Q1','26','1','Wednesday','Wed','January','Jan','1','4','1','2022','20','2022-01-24','2022-01-01','2022-01-01','2022-01-01','2022-01-30','2022-01-31','2022-03-31','2022-12-31','2022-01-31','2022-03-31','2022-12-30','2022-01-26','3','26','26','122','488','1464','6369','44585','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2022-01-27','2022D27','2022W04','2022M01','2022Q1','27','1','Thursday','Thu','January','Jan','1','4','1','2022','20','2022-01-24','2022-01-01','2022-01-01','2022-01-01','2022-01-30','2022-01-31','2022-03-31','2022-12-31','2022-01-31','2022-03-31','2022-12-30','2022-01-27','4','27','27','122','488','1464','6369','44586','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2022-01-28','2022D28','2022W04','2022M01','2022Q1','28','1','Friday','Fri','January','Jan','1','4','1','2022','20','2022-01-24','2022-01-01','2022-01-01','2022-01-01','2022-01-30','2022-01-31','2022-03-31','2022-12-31','2022-01-31','2022-03-31','2022-12-30','2022-01-28','5','28','28','122','488','1464','6369','44587','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2022-01-29','2022D29','2022W04','2022M01','2022Q1','29','0','Saturday','Sat','January','Jan','1','4','1','2022','20','2022-01-24','2022-01-01','2022-01-01','2022-01-01','2022-01-30','2022-01-31','2022-03-31','2022-12-31','2022-01-31','2022-03-31','2022-12-30','2022-01-28','6','29','29','122','488','1464','6369','44588','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2022-01-30','2022D30','2022W04','2022M01','2022Q1','30','0','Sunday','Sun','January','Jan','1','4','1','2022','20','2022-01-24','2022-01-01','2022-01-01','2022-01-01','2022-01-30','2022-01-31','2022-03-31','2022-12-31','2022-01-31','2022-03-31','2022-12-30','2022-01-28','7','30','30','122','488','1464','6369','44589','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2022-01-31','2022D31','2022W05','2022M01','2022Q1','31','1','Monday','Mon','January','Jan','1','5','1','2022','20','2022-01-31','2022-01-01','2022-01-01','2022-01-01','2022-02-06','2022-01-31','2022-03-31','2022-12-31','2022-01-31','2022-03-31','2022-12-30','2022-01-31','1','31','31','122','488','1464','6370','44590','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2022-02-01','2022D32','2022W05','2022M02','2022Q1','1','1','Tuesday','Tue','February','Feb','2','5','1','2022','20','2022-01-31','2022-02-01','2022-01-01','2022-01-01','2022-02-06','2022-02-28','2022-03-31','2022-12-31','2022-02-28','2022-03-31','2022-12-30','2022-02-01','2','32','32','122','488','1465','6370','44591','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2022-02-02','2022D33','2022W05','2022M02','2022Q1','2','1','Wednesday','Wed','February','Feb','2','5','1','2022','20','2022-01-31','2022-02-01','2022-01-01','2022-01-01','2022-02-06','2022-02-28','2022-03-31','2022-12-31','2022-02-28','2022-03-31','2022-12-30','2022-02-02','3','33','33','122','488','1465','6370','44592','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2022-02-03','2022D34','2022W05','2022M02','2022Q1','3','1','Thursday','Thu','February','Feb','2','5','1','2022','20','2022-01-31','2022-02-01','2022-01-01','2022-01-01','2022-02-06','2022-02-28','2022-03-31','2022-12-31','2022-02-28','2022-03-31','2022-12-30','2022-02-03','4','34','34','122','488','1465','6370','44593','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2022-02-04','2022D35','2022W05','2022M02','2022Q1','4','1','Friday','Fri','February','Feb','2','5','1','2022','20','2022-01-31','2022-02-01','2022-01-01','2022-01-01','2022-02-06','2022-02-28','2022-03-31','2022-12-31','2022-02-28','2022-03-31','2022-12-30','2022-02-04','5','35','35','122','488','1465','6370','44594','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2022-02-05','2022D36','2022W05','2022M02','2022Q1','5','0','Saturday','Sat','February','Feb','2','5','1','2022','20','2022-01-31','2022-02-01','2022-01-01','2022-01-01','2022-02-06','2022-02-28','2022-03-31','2022-12-31','2022-02-28','2022-03-31','2022-12-30','2022-02-04','6','36','36','122','488','1465','6370','44595','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2022-02-06','2022D37','2022W05','2022M02','2022Q1','6','0','Sunday','Sun','February','Feb','2','5','1','2022','20','2022-01-31','2022-02-01','2022-01-01','2022-01-01','2022-02-06','2022-02-28','2022-03-31','2022-12-31','2022-02-28','2022-03-31','2022-12-30','2022-02-04','7','37','37','122','488','1465','6370','44596','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2022-02-07','2022D38','2022W06','2022M02','2022Q1','7','1','Monday','Mon','February','Feb','2','6','1','2022','20','2022-02-07','2022-02-01','2022-01-01','2022-01-01','2022-02-13','2022-02-28','2022-03-31','2022-12-31','2022-02-28','2022-03-31','2022-12-30','2022-02-07','1','38','38','122','488','1465','6371','44597','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2022-02-08','2022D39','2022W06','2022M02','2022Q1','8','1','Tuesday','Tue','February','Feb','2','6','1','2022','20','2022-02-07','2022-02-01','2022-01-01','2022-01-01','2022-02-13','2022-02-28','2022-03-31','2022-12-31','2022-02-28','2022-03-31','2022-12-30','2022-02-08','2','39','39','122','488','1465','6371','44598','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2022-02-09','2022D40','2022W06','2022M02','2022Q1','9','1','Wednesday','Wed','February','Feb','2','6','1','2022','20','2022-02-07','2022-02-01','2022-01-01','2022-01-01','2022-02-13','2022-02-28','2022-03-31','2022-12-31','2022-02-28','2022-03-31','2022-12-30','2022-02-09','3','40','40','122','488','1465','6371','44599','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2022-02-10','2022D41','2022W06','2022M02','2022Q1','10','1','Thursday','Thu','February','Feb','2','6','1','2022','20','2022-02-07','2022-02-01','2022-01-01','2022-01-01','2022-02-13','2022-02-28','2022-03-31','2022-12-31','2022-02-28','2022-03-31','2022-12-30','2022-02-10','4','41','41','122','488','1465','6371','44600','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2022-02-11','2022D42','2022W06','2022M02','2022Q1','11','1','Friday','Fri','February','Feb','2','6','1','2022','20','2022-02-07','2022-02-01','2022-01-01','2022-01-01','2022-02-13','2022-02-28','2022-03-31','2022-12-31','2022-02-28','2022-03-31','2022-12-30','2022-02-11','5','42','42','122','488','1465','6371','44601','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2022-02-12','2022D43','2022W06','2022M02','2022Q1','12','0','Saturday','Sat','February','Feb','2','6','1','2022','20','2022-02-07','2022-02-01','2022-01-01','2022-01-01','2022-02-13','2022-02-28','2022-03-31','2022-12-31','2022-02-28','2022-03-31','2022-12-30','2022-02-11','6','43','43','122','488','1465','6371','44602','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2022-02-13','2022D44','2022W06','2022M02','2022Q1','13','0','Sunday','Sun','February','Feb','2','6','1','2022','20','2022-02-07','2022-02-01','2022-01-01','2022-01-01','2022-02-13','2022-02-28','2022-03-31','2022-12-31','2022-02-28','2022-03-31','2022-12-30','2022-02-11','7','44','44','122','488','1465','6371','44603','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2022-02-14','2022D45','2022W07','2022M02','2022Q1','14','1','Monday','Mon','February','Feb','2','7','1','2022','20','2022-02-14','2022-02-01','2022-01-01','2022-01-01','2022-02-20','2022-02-28','2022-03-31','2022-12-31','2022-02-28','2022-03-31','2022-12-30','2022-02-14','1','45','45','122','488','1465','6372','44604','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2022-02-15','2022D46','2022W07','2022M02','2022Q1','15','1','Tuesday','Tue','February','Feb','2','7','1','2022','20','2022-02-14','2022-02-01','2022-01-01','2022-01-01','2022-02-20','2022-02-28','2022-03-31','2022-12-31','2022-02-28','2022-03-31','2022-12-30','2022-02-15','2','46','46','122','488','1465','6372','44605','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2022-02-16','2022D47','2022W07','2022M02','2022Q1','16','1','Wednesday','Wed','February','Feb','2','7','1','2022','20','2022-02-14','2022-02-01','2022-01-01','2022-01-01','2022-02-20','2022-02-28','2022-03-31','2022-12-31','2022-02-28','2022-03-31','2022-12-30','2022-02-16','3','47','47','122','488','1465','6372','44606','1','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2022-02-17','2022D48','2022W07','2022M02','2022Q1','17','1','Thursday','Thu','February','Feb','2','7','1','2022','20','2022-02-14','2022-02-01','2022-01-01','2022-01-01','2022-02-20','2022-02-28','2022-03-31','2022-12-31','2022-02-28','2022-03-31','2022-12-30','2022-02-17','4','48','48','122','488','1465','6372','44607','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2022-02-18','2022D49','2022W07','2022M02','2022Q1','18','1','Friday','Fri','February','Feb','2','7','1','2022','20','2022-02-14','2022-02-01','2022-01-01','2022-01-01','2022-02-20','2022-02-28','2022-03-31','2022-12-31','2022-02-28','2022-03-31','2022-12-30','2022-02-18','5','49','49','122','488','1465','6372','44608','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2022-02-19','2022D50','2022W07','2022M02','2022Q1','19','0','Saturday','Sat','February','Feb','2','7','1','2022','20','2022-02-14','2022-02-01','2022-01-01','2022-01-01','2022-02-20','2022-02-28','2022-03-31','2022-12-31','2022-02-28','2022-03-31','2022-12-30','2022-02-18','6','50','50','122','488','1465','6372','44609','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2022-02-20','2022D51','2022W07','2022M02','2022Q1','20','0','Sunday','Sun','February','Feb','2','7','1','2022','20','2022-02-14','2022-02-01','2022-01-01','2022-01-01','2022-02-20','2022-02-28','2022-03-31','2022-12-31','2022-02-28','2022-03-31','2022-12-30','2022-02-18','7','51','51','122','488','1465','6372','44610','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2022-02-21','2022D52','2022W08','2022M02','2022Q1','21','1','Monday','Mon','February','Feb','2','8','1','2022','20','2022-02-21','2022-02-01','2022-01-01','2022-01-01','2022-02-27','2022-02-28','2022-03-31','2022-12-31','2022-02-28','2022-03-31','2022-12-30','2022-02-21','1','52','52','122','488','1465','6373','44611','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2022-02-22','2022D53','2022W08','2022M02','2022Q1','22','1','Tuesday','Tue','February','Feb','2','8','1','2022','20','2022-02-21','2022-02-01','2022-01-01','2022-01-01','2022-02-27','2022-02-28','2022-03-31','2022-12-31','2022-02-28','2022-03-31','2022-12-30','2022-02-22','2','53','53','122','488','1465','6373','44612','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2022-02-23','2022D54','2022W08','2022M02','2022Q1','23','1','Wednesday','Wed','February','Feb','2','8','1','2022','20','2022-02-21','2022-02-01','2022-01-01','2022-01-01','2022-02-27','2022-02-28','2022-03-31','2022-12-31','2022-02-28','2022-03-31','2022-12-30','2022-02-23','3','54','54','122','488','1465','6373','44613','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2022-02-24','2022D55','2022W08','2022M02','2022Q1','24','1','Thursday','Thu','February','Feb','2','8','1','2022','20','2022-02-21','2022-02-01','2022-01-01','2022-01-01','2022-02-27','2022-02-28','2022-03-31','2022-12-31','2022-02-28','2022-03-31','2022-12-30','2022-02-24','4','55','55','122','488','1465','6373','44614','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2022-02-25','2022D56','2022W08','2022M02','2022Q1','25','1','Friday','Fri','February','Feb','2','8','1','2022','20','2022-02-21','2022-02-01','2022-01-01','2022-01-01','2022-02-27','2022-02-28','2022-03-31','2022-12-31','2022-02-28','2022-03-31','2022-12-30','2022-02-25','5','56','56','122','488','1465','6373','44615','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2022-02-26','2022D57','2022W08','2022M02','2022Q1','26','0','Saturday','Sat','February','Feb','2','8','1','2022','20','2022-02-21','2022-02-01','2022-01-01','2022-01-01','2022-02-27','2022-02-28','2022-03-31','2022-12-31','2022-02-28','2022-03-31','2022-12-30','2022-02-25','6','57','57','122','488','1465','6373','44616','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2022-02-27','2022D58','2022W08','2022M02','2022Q1','27','0','Sunday','Sun','February','Feb','2','8','1','2022','20','2022-02-21','2022-02-01','2022-01-01','2022-01-01','2022-02-27','2022-02-28','2022-03-31','2022-12-31','2022-02-28','2022-03-31','2022-12-30','2022-02-25','7','58','58','122','488','1465','6373','44617','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2022-02-28','2022D59','2022W09','2022M02','2022Q1','28','1','Monday','Mon','February','Feb','2','9','1','2022','20','2022-02-28','2022-02-01','2022-01-01','2022-01-01','2022-03-06','2022-02-28','2022-03-31','2022-12-31','2022-02-28','2022-03-31','2022-12-30','2022-02-28','1','59','59','122','488','1465','6374','44618','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2022-03-01','2022D60','2022W09','2022M03','2022Q1','1','1','Tuesday','Tue','March','Mar','3','9','1','2022','20','2022-02-28','2022-03-01','2022-01-01','2022-01-01','2022-03-06','2022-03-31','2022-03-31','2022-12-31','2022-03-31','2022-03-31','2022-12-30','2022-03-01','2','60','60','122','488','1466','6374','44619','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2022-03-02','2022D61','2022W09','2022M03','2022Q1','2','1','Wednesday','Wed','March','Mar','3','9','1','2022','20','2022-02-28','2022-03-01','2022-01-01','2022-01-01','2022-03-06','2022-03-31','2022-03-31','2022-12-31','2022-03-31','2022-03-31','2022-12-30','2022-03-02','3','61','61','122','488','1466','6374','44620','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2022-03-03','2022D62','2022W09','2022M03','2022Q1','3','1','Thursday','Thu','March','Mar','3','9','1','2022','20','2022-02-28','2022-03-01','2022-01-01','2022-01-01','2022-03-06','2022-03-31','2022-03-31','2022-12-31','2022-03-31','2022-03-31','2022-12-30','2022-03-03','4','62','62','122','488','1466','6374','44621','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2022-03-04','2022D63','2022W09','2022M03','2022Q1','4','1','Friday','Fri','March','Mar','3','9','1','2022','20','2022-02-28','2022-03-01','2022-01-01','2022-01-01','2022-03-06','2022-03-31','2022-03-31','2022-12-31','2022-03-31','2022-03-31','2022-12-30','2022-03-04','5','63','63','122','488','1466','6374','44622','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2022-03-05','2022D64','2022W09','2022M03','2022Q1','5','0','Saturday','Sat','March','Mar','3','9','1','2022','20','2022-02-28','2022-03-01','2022-01-01','2022-01-01','2022-03-06','2022-03-31','2022-03-31','2022-12-31','2022-03-31','2022-03-31','2022-12-30','2022-03-04','6','64','64','122','488','1466','6374','44623','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2022-03-06','2022D65','2022W09','2022M03','2022Q1','6','0','Sunday','Sun','March','Mar','3','9','1','2022','20','2022-02-28','2022-03-01','2022-01-01','2022-01-01','2022-03-06','2022-03-31','2022-03-31','2022-12-31','2022-03-31','2022-03-31','2022-12-30','2022-03-04','7','65','65','122','488','1466','6374','44624','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2022-03-07','2022D66','2022W10','2022M03','2022Q1','7','1','Monday','Mon','March','Mar','3','10','1','2022','20','2022-03-07','2022-03-01','2022-01-01','2022-01-01','2022-03-13','2022-03-31','2022-03-31','2022-12-31','2022-03-31','2022-03-31','2022-12-30','2022-03-07','1','66','66','122','488','1466','6375','44625','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2022-03-08','2022D67','2022W10','2022M03','2022Q1','8','1','Tuesday','Tue','March','Mar','3','10','1','2022','20','2022-03-07','2022-03-01','2022-01-01','2022-01-01','2022-03-13','2022-03-31','2022-03-31','2022-12-31','2022-03-31','2022-03-31','2022-12-30','2022-03-08','2','67','67','122','488','1466','6375','44626','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2022-03-09','2022D68','2022W10','2022M03','2022Q1','9','1','Wednesday','Wed','March','Mar','3','10','1','2022','20','2022-03-07','2022-03-01','2022-01-01','2022-01-01','2022-03-13','2022-03-31','2022-03-31','2022-12-31','2022-03-31','2022-03-31','2022-12-30','2022-03-09','3','68','68','122','488','1466','6375','44627','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2022-03-10','2022D69','2022W10','2022M03','2022Q1','10','1','Thursday','Thu','March','Mar','3','10','1','2022','20','2022-03-07','2022-03-01','2022-01-01','2022-01-01','2022-03-13','2022-03-31','2022-03-31','2022-12-31','2022-03-31','2022-03-31','2022-12-30','2022-03-10','4','69','69','122','488','1466','6375','44628','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2022-03-11','2022D70','2022W10','2022M03','2022Q1','11','1','Friday','Fri','March','Mar','3','10','1','2022','20','2022-03-07','2022-03-01','2022-01-01','2022-01-01','2022-03-13','2022-03-31','2022-03-31','2022-12-31','2022-03-31','2022-03-31','2022-12-30','2022-03-11','5','70','70','122','488','1466','6375','44629','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2022-03-12','2022D71','2022W10','2022M03','2022Q1','12','0','Saturday','Sat','March','Mar','3','10','1','2022','20','2022-03-07','2022-03-01','2022-01-01','2022-01-01','2022-03-13','2022-03-31','2022-03-31','2022-12-31','2022-03-31','2022-03-31','2022-12-30','2022-03-11','6','71','71','122','488','1466','6375','44630','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2022-03-13','2022D72','2022W10','2022M03','2022Q1','13','0','Sunday','Sun','March','Mar','3','10','1','2022','20','2022-03-07','2022-03-01','2022-01-01','2022-01-01','2022-03-13','2022-03-31','2022-03-31','2022-12-31','2022-03-31','2022-03-31','2022-12-30','2022-03-11','7','72','72','122','488','1466','6375','44631','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2022-03-14','2022D73','2022W11','2022M03','2022Q1','14','1','Monday','Mon','March','Mar','3','11','1','2022','20','2022-03-14','2022-03-01','2022-01-01','2022-01-01','2022-03-20','2022-03-31','2022-03-31','2022-12-31','2022-03-31','2022-03-31','2022-12-30','2022-03-14','1','73','73','122','488','1466','6376','44632','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2022-03-15','2022D74','2022W11','2022M03','2022Q1','15','1','Tuesday','Tue','March','Mar','3','11','1','2022','20','2022-03-14','2022-03-01','2022-01-01','2022-01-01','2022-03-20','2022-03-31','2022-03-31','2022-12-31','2022-03-31','2022-03-31','2022-12-30','2022-03-15','2','74','74','122','488','1466','6376','44633','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2022-03-16','2022D75','2022W11','2022M03','2022Q1','16','1','Wednesday','Wed','March','Mar','3','11','1','2022','20','2022-03-14','2022-03-01','2022-01-01','2022-01-01','2022-03-20','2022-03-31','2022-03-31','2022-12-31','2022-03-31','2022-03-31','2022-12-30','2022-03-16','3','75','75','122','488','1466','6376','44634','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2022-03-17','2022D76','2022W11','2022M03','2022Q1','17','1','Thursday','Thu','March','Mar','3','11','1','2022','20','2022-03-14','2022-03-01','2022-01-01','2022-01-01','2022-03-20','2022-03-31','2022-03-31','2022-12-31','2022-03-31','2022-03-31','2022-12-30','2022-03-17','4','76','76','122','488','1466','6376','44635','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2022-03-18','2022D77','2022W11','2022M03','2022Q1','18','1','Friday','Fri','March','Mar','3','11','1','2022','20','2022-03-14','2022-03-01','2022-01-01','2022-01-01','2022-03-20','2022-03-31','2022-03-31','2022-12-31','2022-03-31','2022-03-31','2022-12-30','2022-03-18','5','77','77','122','488','1466','6376','44636','1','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2022-03-19','2022D78','2022W11','2022M03','2022Q1','19','0','Saturday','Sat','March','Mar','3','11','1','2022','20','2022-03-14','2022-03-01','2022-01-01','2022-01-01','2022-03-20','2022-03-31','2022-03-31','2022-12-31','2022-03-31','2022-03-31','2022-12-30','2022-03-18','6','78','78','122','488','1466','6376','44637','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2022-03-20','2022D79','2022W11','2022M03','2022Q1','20','0','Sunday','Sun','March','Mar','3','11','1','2022','20','2022-03-14','2022-03-01','2022-01-01','2022-01-01','2022-03-20','2022-03-31','2022-03-31','2022-12-31','2022-03-31','2022-03-31','2022-12-30','2022-03-18','7','79','79','122','488','1466','6376','44638','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2022-03-21','2022D80','2022W12','2022M03','2022Q1','21','1','Monday','Mon','March','Mar','3','12','1','2022','20','2022-03-21','2022-03-01','2022-01-01','2022-01-01','2022-03-27','2022-03-31','2022-03-31','2022-12-31','2022-03-31','2022-03-31','2022-12-30','2022-03-21','1','80','80','122','488','1466','6377','44639','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2022-03-22','2022D81','2022W12','2022M03','2022Q1','22','1','Tuesday','Tue','March','Mar','3','12','1','2022','20','2022-03-21','2022-03-01','2022-01-01','2022-01-01','2022-03-27','2022-03-31','2022-03-31','2022-12-31','2022-03-31','2022-03-31','2022-12-30','2022-03-22','2','81','81','122','488','1466','6377','44640','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2022-03-23','2022D82','2022W12','2022M03','2022Q1','23','1','Wednesday','Wed','March','Mar','3','12','1','2022','20','2022-03-21','2022-03-01','2022-01-01','2022-01-01','2022-03-27','2022-03-31','2022-03-31','2022-12-31','2022-03-31','2022-03-31','2022-12-30','2022-03-23','3','82','82','122','488','1466','6377','44641','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2022-03-24','2022D83','2022W12','2022M03','2022Q1','24','1','Thursday','Thu','March','Mar','3','12','1','2022','20','2022-03-21','2022-03-01','2022-01-01','2022-01-01','2022-03-27','2022-03-31','2022-03-31','2022-12-31','2022-03-31','2022-03-31','2022-12-30','2022-03-24','4','83','83','122','488','1466','6377','44642','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2022-03-25','2022D84','2022W12','2022M03','2022Q1','25','1','Friday','Fri','March','Mar','3','12','1','2022','20','2022-03-21','2022-03-01','2022-01-01','2022-01-01','2022-03-27','2022-03-31','2022-03-31','2022-12-31','2022-03-31','2022-03-31','2022-12-30','2022-03-25','5','84','84','122','488','1466','6377','44643','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2022-03-26','2022D85','2022W12','2022M03','2022Q1','26','0','Saturday','Sat','March','Mar','3','12','1','2022','20','2022-03-21','2022-03-01','2022-01-01','2022-01-01','2022-03-27','2022-03-31','2022-03-31','2022-12-31','2022-03-31','2022-03-31','2022-12-30','2022-03-25','6','85','85','122','488','1466','6377','44644','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2022-03-27','2022D86','2022W12','2022M03','2022Q1','27','0','Sunday','Sun','March','Mar','3','12','1','2022','20','2022-03-21','2022-03-01','2022-01-01','2022-01-01','2022-03-27','2022-03-31','2022-03-31','2022-12-31','2022-03-31','2022-03-31','2022-12-30','2022-03-25','7','86','86','122','488','1466','6377','44645','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2022-03-28','2022D87','2022W13','2022M03','2022Q1','28','1','Monday','Mon','March','Mar','3','13','1','2022','20','2022-03-28','2022-03-01','2022-01-01','2022-01-01','2022-04-03','2022-03-31','2022-03-31','2022-12-31','2022-03-31','2022-03-31','2022-12-30','2022-03-28','1','87','87','122','488','1466','6378','44646','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2022-03-29','2022D88','2022W13','2022M03','2022Q1','29','1','Tuesday','Tue','March','Mar','3','13','1','2022','20','2022-03-28','2022-03-01','2022-01-01','2022-01-01','2022-04-03','2022-03-31','2022-03-31','2022-12-31','2022-03-31','2022-03-31','2022-12-30','2022-03-29','2','88','88','122','488','1466','6378','44647','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2022-03-30','2022D89','2022W13','2022M03','2022Q1','30','1','Wednesday','Wed','March','Mar','3','13','1','2022','20','2022-03-28','2022-03-01','2022-01-01','2022-01-01','2022-04-03','2022-03-31','2022-03-31','2022-12-31','2022-03-31','2022-03-31','2022-12-30','2022-03-30','3','89','89','122','488','1466','6378','44648','0','0','0','0','','2022-08-29 09:01:26.503255 UTC'), 
 ('2022-03-31','2022D90','2022W13','2022M03','2022Q1','31','1','Thursday','Thu','March','Mar','3','13','1','2022','20','2022-03-28','2022-03-01','2022-01-01','2022-01-01','2022-04-03','2022-03-31','2022-03-31','2022-12-31','2022-03-31','2022-03-31','2022-12-30','2022-03-31','4','90','90','122','488','1466','6378','44649','0','0','0','0','','2022-08-29 09:01:26.503255 UTC');

DROP TABLE #dim_platform
CREATE TABLE #dim_platform (
							platform_id INT
							,platform VARCHAR(50)
							,valid_from DATE
							,valid_to DATE);
INSERT INTO #dim_platform (platform_id,platform,valid_from,valid_to) VALUES 
('500','Anibis','2000-01-01','2021-12-31'), 
 ('500','Anibis.ch','2021-12-31', NULL), 
 ('510','Ricardo','2000-01-01', NULL), 
 ('520','Tutti.ch','2000-01-01','2021-12-31'), 
 ('520','Tutti','2021-12-31', NULL)

 DROP TABLE #dim_product_type
CREATE TABLE #dim_product_type (
								product_type_id INT
								,product_type_name VARCHAR(50)
								,valid_from DATE
								,valid_to DATE
								);
INSERT INTO #dim_product_type (product_type_id,product_type_name,valid_from,valid_to) VALUES 
 ('10000','Tennis racket','2000-01-01', NULL), 
 ('10001','Baseball','2000-01-01', NULL), 
 ('10002','Winter hiking boots','2000-01-01', NULL), 
 ('10003','Snowboard','2000-01-01', NULL), 
 ('10004','Skiis','2000-01-01', NULL), 
 ('10005','Climbing shoes','2000-01-01', NULL), 
 ('10006','Christmas tree','2000-01-01', NULL), 
 ('10007','3D glasses','2000-01-01', NULL), 
 ('10008','Mountain Bike','2000-01-01', NULL), 
 ('10009','Mousepad','2000-01-01', NULL), 
 ('10010','Glass bottle','2000-01-01', NULL), 
 ('10011','Iron','2000-01-01', NULL), 
 ('10012','Radio','2000-01-01', NULL), 
 ('10013','Vynil','2000-01-01', NULL), 
 ('10014','Notebook','2000-01-01', NULL), 
 ('10015','Keyboard','2000-01-01', NULL), 
 ('10016','Piano','2000-01-01', NULL), 
 ('10017','Guitar','2000-01-01', NULL), 
 ('10018','Book','2000-01-01', NULL), 
 ('10019','Watch','2000-01-01', NULL), 
 ('10020','Monitor','2000-01-01', NULL), 
 ('10021','Plant','2000-01-01', NULL), 
 ('10022','Table','2000-01-01', NULL), 
 ('10023','Chair','2000-01-01', NULL), 
 ('10024','Sofaa','2000-01-01','2001-12-31'), 
 ('10024','Sofa','2001-12-31', NULL), 
 ('10025','Lamp','2000-01-01', NULL), 
 ('10026','Mirror','2000-01-01', NULL), 
 ('10027','Carpet','2000-01-01', NULL), 
 ('10028','Mattress','2000-01-01', NULL);

 DROP TABLE #dim_status
CREATE TABLE #dim_status (
						   status_id INT
						   ,status_description VARCHAR(50)
						   ,valid_from DATE
						   ,valid_to DATE);

INSERT INTO #dim_status (status_id,status_description,valid_from,valid_to) VALUES 
('10','Active','2000-01-01', NULL),
('15','Sold','2000-01-01', NULL),
('20','Inactive','2000-01-01', NULL),
('25','Cancelled','2000-01-01', NULL);

 DROP TABLE #dim_user
CREATE TABLE #dim_user (
						user_id INT
						,city VARCHAR(50)
						,valid_from DATE
						,valid_to DATE
						);
INSERT INTO #dim_user (user_id,city,valid_from,valid_to) VALUES  
 ('990001','Zurich','2000-01-01', NULL), 
 ('990002','Geneva','2008-06-02', NULL), 
 ('990003','Luzern','2008-12-06', NULL), 
 ('990004','Lugano','2008-12-31', NULL), 
 ('990005','Basel','2009-01-30', NULL), 
 ('990006','Zurich','2009-02-26', NULL), 
 ('990007','Geneva','2010-01-03','2022-01-21'), 
 ('990007','Luzern','2022-01-21', NULL), 
 ('990009','Lugano','2010-03-03', NULL), 
 ('990010','Basel','2011-04-06', NULL), 
 ('990011','Zurich','2011-06-09', NULL), 
 ('990012','Geneva','2012-01-02', NULL), 
 ('990013','Luzern','2012-06-09', NULL), 
 ('990014','Lugano','2013-01-01', NULL), 
 ('990015','Basel','2014-12-16', NULL), 
 ('990016','Zurich','2014-12-28', NULL), 
 ('990017','Geneva','2015-06-06', NULL), 
 ('990018','Luzern','2015-07-09', NULL), 
 ('990019','Lugano','2016-03-06', NULL), 
 ('990020','Basel','2016-08-02', NULL), 
 ('990021','Zurich','2017-01-09', NULL), 
 ('990022','Geneva','2018-06-12', NULL), 
 ('990023','Luzern','2019-09-09', NULL), 
 ('990024','Geneva','2020-12-28', NULL), 
 ('990025','Geneva','2020-12-31', NULL), 
 ('990026','Luzern','2021-09-18', NULL), 
 ('990027','Lugano','2021-12-31', NULL), 
 ('990028','Basel','2022-02-01', NULL), 
 ('990029','Zurich','2022-03-03', NULL);

 DROP TABLE #fct_listings
CREATE TABLE #fct_listings (
						   listing_date_key VARCHAR(50)
						   ,listing_id INT
						   ,platform_id INT
						   ,product_type_id INT
						   ,user_id INT
						   ,price VARCHAR(50)
						   ,status_id INT
						   ,valid_from DATE
						   ,valid_to DATE);
INSERT INTO #fct_listings (listing_date_key,listing_id,platform_id,product_type_id,user_id,price,status_id,valid_from,valid_to) VALUES 
 ('2021-12-01','551236','500','10000','990001','100.69','10','2021-12-01', NULL), 
 ('2021-12-01','551237','500','10001','990002','200','10','2021-12-01', NULL), 
 ('2021-12-02','551238','510','10002','990003','58','10','2021-12-02', NULL), 
 ('2021-12-02','551239','520','10003','990004','369','10','2021-12-02', NULL), 
 ('2021-12-02','551240','520','10004','990005','452','10','2021-12-02', NULL), 
 ('2021-12-03','551241','500','10005','990006','3,336.00','10','2021-12-03', NULL), 
 ('2021-12-04','551242','500','10006','990007','1,242.00','10','2021-12-04', NULL), 
 ('2021-12-05','551243','510','10007','990009','289','10','2021-12-05', NULL), 
 ('2021-12-06','551244','520','10008','990010','20','10','2021-12-06', NULL), 
 ('2021-12-07','551245','520','10009','990011','1','10','2021-12-07', NULL), 
 ('2021-12-08','551246','500','10010','990012','458','10','2021-12-08','2021-12-09'), 
 ('2021-12-09','551246','500','10010','990012','458','15','2021-12-09', NULL), 
 ('2021-12-09','551247','500','10011','990013','122','10','2021-12-09','2022-01-09'), 
 ('2022-01-09','551247','500','10011','990013','122','15','2022-01-09', NULL), 
 ('2021-12-10','551248','510','10012','990014','787','10','2021-12-10','2022-01-09'), 
 ('2022-01-09','551248','510','10012','990014','787','15','2022-01-09', NULL), 
 ('2021-12-11','551249','520','10013','990015','55','10','2021-12-11','2022-01-10'), 
 ('2022-01-10','551249','520','10013','990015','55','20','2022-01-10', NULL), 
 ('2021-12-12','551250','520','10014','990016','66.96','10','2021-12-12','2022-01-13'), 
 ('2022-01-13','551250','520','10014','990016','66.96','15','2022-01-13', NULL), 
 ('2021-12-13','551251','500','10015','990017','984','10','2021-12-13','2022-01-15'), 
 ('2022-01-15','551251','500','10015','990017','984','15','2022-01-15', NULL), 
 ('2021-12-14','551252','500','10016','990018','452','10','2021-12-14','2022-01-16'), 
 ('2022-01-16','551252','500','10016','990018','452','15','2022-01-16', NULL), 
 ('2021-12-15','551253','510','10017','990019','856','10','2021-12-15','2022-01-30'), 
 ('2022-01-30','551253','510','10017','990019','856','15','2022-01-30', NULL), 
 ('2021-12-16','551254','520','10018','990020','85','10','2021-12-16','2022-01-01'), 
 ('2022-01-01','551254','520','10018','990020','85','15','2022-01-01', NULL), 
 ('2021-12-17','551255','520','10019','990021','45','10','2021-12-17', NULL), 
 ('2021-12-18','551256','520','10020','990022','36.87','10','2021-12-18', NULL), 
 ('2021-12-19','551257','520','10021','990023','85','10','2021-12-19', NULL), 
 ('2021-12-20','551258','500','10022','990024','912','10','2021-12-20', NULL), 
 ('2021-12-21','551259','500','10023','990025','128','10','2021-12-21', NULL), 
 ('2021-12-22','551260','510','10024','990026','128','10','2021-12-22', NULL), 
 ('2021-12-23','551261','520','10024','990027','458','10','2021-12-23', NULL), 
 ('2021-12-24','551262','520','10025','990028','12','10','2021-12-24', NULL), 
 ('2021-12-25','551263','500','10026','990029','36','10','2021-12-25', NULL), 
 ('2021-12-26','551264','500','10027','990001','58','10','2021-12-26', NULL), 
 ('2021-12-27','551265','510','10028','990002','22','10','2021-12-27', NULL), 
 ('2021-12-28','551266','520','10000','990003','1','10','2021-12-28', NULL), 
 ('2021-12-29','551267','500','10001','990004','8','10','2021-12-29', NULL), 
 ('2021-12-30','551268','500','10002','990005','9','10','2021-12-30', NULL), 
 ('2021-12-31','551269','510','10003','990006','877.69','10','2021-12-31', NULL), 
 ('2022-01-01','551270','520','10004','990007','5','10','2022-01-01', NULL), 
 ('2022-01-02','551271','520','10005','990009','6','10','2022-01-02', NULL), 
 ('2022-01-03','551272','500','10006','990010','200','10','2022-01-03', NULL), 
 ('2022-01-04','551273','500','10007','990011','200','10','2022-01-04', NULL), 
 ('2022-01-05','551274','510','10008','990012','58','10','2022-01-05', NULL), 
 ('2022-01-06','551275','520','10009','990013','369','10','2022-01-06', NULL), 
 ('2022-01-07','551276','520','10010','990014','452','10','2022-01-07', NULL), 
 ('2022-01-08','551277','500','10011','990015','3,336.00','10','2022-01-08', NULL), 
 ('2022-01-09','551278','500','10012','990016','1,242.00','10','2022-01-09','2022-01-10'), 
 ('2022-01-10','551278','500','10012','990016','1,242.00','15','2022-01-10', NULL), 
 ('2022-01-10','551279','510','10013','990017','289','10','2022-01-10','2022-01-18'), 
 ('2022-01-18','551279','510','10013','990017','289','15','2022-01-18', NULL), 
 ('2022-01-11','551280','520','10014','990018','20','10','2022-01-11','2022-01-20'), 
 ('2022-01-20','551280','520','10014','990018','20','15','2022-01-20', NULL), 
 ('2022-01-12','551281','520','10019','990019','20','10','2022-01-12','2022-01-20'), 
 ('2022-01-20','551281','520','10019','990019','20','15','2022-01-20', NULL), 
 ('2022-01-13','551282','500','10020','990020','3,336.00','10','2022-01-13','2022-01-26'), 
 ('2022-01-26','551282','500','10020','990020','3,336.00','15','2022-01-26', NULL), 
 ('2022-01-14','551283','500','10021','990021','78','10','2022-01-14','2022-01-24'), 
 ('2022-01-24','551283','500','10021','990021','78','15','2022-01-24', NULL), 
 ('2022-01-15','551284','510','10022','990022','22','10','2022-01-15','2022-01-25'), 
 ('2022-01-25','551284','510','10022','990022','22','15','2022-01-25', NULL), 
 ('2021-12-10','551285','500','10010','990022','458','10','2021-12-10','2021-12-11'), 
 ('2021-12-11','551285','500','10010','990022','458','15','2021-12-11', NULL), 
 ('2021-12-10','551286','500','10010','990022','458','10','2021-12-10','2021-12-11'), 
 ('2021-12-11','551286','500','10010','990022','458','15','2021-12-11', NULL), 
 ('2021-12-12','551287','500','10010','990022','458','10','2021-12-12','2021-12-14'), 
 ('2021-12-14','551287','500','10010','990022','458','15','2021-12-14', NULL), 
 ('2021-12-15','551288','500','10010','990022','458','10','2021-12-15','2021-12-18'), 
 ('2021-12-18','551288','500','10010','990022','458','15','2021-12-18', NULL), 
 ('2021-12-19','551289','500','10010','990022','458','10','2021-12-19','2021-12-20'), 
 ('2021-12-20','551289','500','10010','990022','458','15','2021-12-20', NULL), 
 ('2021-12-25','551290','500','10010','990022','458','10','2021-12-25','2021-12-26'), 
 ('2021-12-26','551290','500','10010','990022','458','15','2021-12-26', NULL), 
 ('2021-12-28','551291','500','10010','990022','458','10','2021-12-28','2021-12-31'), 
 ('2021-12-31','551291','500','10010','990022','458','15','2021-12-31', NULL), 
 ('2022-01-02','551292','500','10010','990022','458','10','2022-01-02','2021-12-11'), 
 ('2022-01-05','551292','500','10010','990022','458','15','2021-12-11', NULL), 
 ('2022-01-07','551293','500','10010','990022','458','10','2022-01-07','2021-12-11'), 
 ('2021-12-08','551293','500','10010','990022','458','15','2021-12-11', NULL), 
 ('2021-12-18','551294','500','10011','990013','122','10','2021-12-18','2021-12-18'), 
 ('2021-12-18','551294','500','10011','990013','122','15','2021-12-18', NULL), 
 ('2021-12-28','551294','500','10011','990013','122','10','2021-12-28','2021-12-28'), 
 ('2022-01-28','551294','500','10011','990013','122','15','2022-01-28', NULL), 
 ('2022-01-08','551295','500','10011','990013','122','10','2022-01-08','2022-01-08'), 
 ('2022-01-08','551295','500','10011','990013','122','15','2022-01-08', NULL), 
 ('2022-01-18','551296','500','10011','990013','122','10','2022-01-18','2022-01-18'), 
 ('2022-01-18','551296','500','10011','990013','122','15','2022-01-18', NULL), 
 ('2022-01-28','551297','500','10011','990013','122','10','2022-01-28','2022-01-28'), 
 ('2022-01-28','551297','500','10011','990013','122','15','2022-01-28', NULL), 
 ('2022-01-05','551298','510','10008','990012','58','10','2022-01-05', NULL), 
 ('2022-01-06','551299','510','10008','990012','58','10','2022-01-06','2022-01-12'), 
 ('2022-01-12','551299','510','10008','990012','58','15','2022-01-12', NULL), 
 ('2022-01-07','551300','510','10008','990012','58','10','2022-01-07','2022-01-14'), 
 ('2022-01-14','551300','510','10008','990012','58','15','2022-01-14', NULL), 
 ('2022-01-08','551301','510','10008','990012','58','10','2022-01-08','2022-01-16'), 
 ('2022-01-16','551301','510','10008','990012','58','15','2022-01-16', NULL), 
 ('2022-01-09','551302','510','10008','990012','58','10','2022-01-09','2022-01-18'), 
 ('2022-01-18','551302','510','10008','990012','58','15','2022-01-18', NULL), 
 ('2022-01-10','551303','510','10008','990012','58','10','2022-01-10','2022-01-20'), 
 ('2022-01-20','551303','510','10008','990012','58','15','2022-01-20', NULL), 
 ('2022-01-11','551304','510','10008','990012','58','10','2022-01-11','2022-01-21'), 
 ('2022-01-21','551304','510','10008','990012','58','15','2022-01-21', NULL), 
 ('2022-01-12','551305','510','10008','990012','58','10','2022-01-12','2022-01-22'), 
 ('2022-01-22','551305','510','10008','990012','58','15','2022-01-22', NULL), 
 ('2022-01-09','551306','510','10003','990001','58','10','2022-01-09','2022-01-18'), 
 ('2022-01-18','551306','510','10003','990001','58','15','2022-01-18', NULL), 
 ('2022-01-10','551307','510','10003','990001','58','10','2022-01-10','2022-01-20'), 
 ('2022-01-20','551307','510','10003','990001','58','15','2022-01-20', NULL), 
 ('2022-01-11','551308','510','10003','990001','58','10','2022-01-11','2022-01-21'), 
 ('2022-01-21','551308','510','10003','990002','58','15','2022-01-21', NULL), 
 ('2022-01-12','551309','510','10003','990002','58','10','2022-01-12','2022-01-22'), 
 ('2022-01-22','551309','510','10003','990002','58','15','2022-01-22', NULL), 
 ('2022-01-07','551310','520','10014','990022','452','10','2022-01-07','2022-01-10'), 
 ('2022-01-10','551310','520','10014','990022','452','10','2022-01-10', NULL), 
 ('2022-01-10','551311','520','10014','990022','452','10','2022-01-10','2022-01-13'), 
 ('2022-01-13','551311','520','10014','990022','452','10','2022-01-13', NULL), 
 ('2022-01-13','551312','520','10014','990022','452','10','2022-01-13','2022-01-16'), 
 ('2022-01-16','551312','520','10014','990022','452','10','2022-01-16', NULL), 
 ('2022-01-16','551313','520','10014','990022','452','10','2022-01-16','2022-01-19'), 
 ('2022-01-19','551313','520','10014','990022','452','10','2022-01-19', NULL), 
 ('2022-01-07','551313','500','10000','990001','100.69','10','2022-01-07','2022-01-14'), 
 ('2022-01-14','551313','500','10000','990001','100.69','15','2022-01-14', NULL), 
 ('2022-01-08','551314','500','10000','990001','100.69','10','2022-01-08','2022-01-16'), 
 ('2022-01-16','551314','500','10000','990001','100.69','15','2022-01-16', NULL), 
 ('2022-01-09','551315','500','10000','990001','100.69','10','2022-01-09','2022-01-18'), 
 ('2022-01-18','551315','500','10000','990001','100.69','15','2022-01-18', NULL), 
 ('2022-01-10','551316','500','10000','990001','100.69','10','2022-01-10','2022-01-20'), 
 ('2022-01-20','551316','500','10000','990001','100.69','15','2022-01-20', NULL), 
 ('2022-01-11','551317','500','10000','990001','100.69','10','2022-01-11','2022-01-21'), 
 ('2022-01-21','551317','500','10000','990001','100.69','15','2022-01-21', NULL), 
 ('2022-01-12','551318','500','10000','990001','100.69','10','2022-01-12','2022-01-22'), 
 ('2022-01-22','551318','500','10000','990001','100.69','15','2022-01-22', NULL), 
 ('2022-01-09','551319','500','10000','990001','100.69','10','2022-01-09','2022-01-18'), 
 ('2022-01-18','551319','500','10000','990001','100.69','15','2022-01-18', NULL), 
 ('2022-01-10','551320','500','10000','990001','100.69','10','2022-01-10','2022-01-20'), 
 ('2022-01-20','551320','500','10000','990001','100.69','15','2022-01-20', NULL), 
 ('2022-01-11','551321','500','10000','990001','100.69','10','2022-01-11','2022-01-21'), 
 ('2022-01-21','551321','500','10000','990001','100.69','15','2022-01-21', NULL), 
 ('2022-01-12','551322','500','10000','990001','100.69','10','2022-01-12','2022-01-22'), 
 ('2022-01-22','551322','500','10000','990001','100.69','15','2022-01-22', NULL), 
 ('2022-01-07','551323','500','10000','990001','100.69','10','2022-01-07','2022-01-10'), 
 ('2022-01-10','551323','500','10000','990001','100.69','10','2022-01-10', NULL), 
 ('2022-01-10','551324','500','10000','990001','100.69','10','2022-01-10','2022-01-13'), 
 ('2022-01-13','551324','500','10000','990001','100.69','10','2022-01-13', NULL), 
 ('2022-01-13','551325','500','10000','990001','100.69','10','2022-01-13','2022-01-16'), 
 ('2022-01-16','551325','500','10000','990001','100.69','10','2022-01-16', NULL), 
 ('2022-01-16','551326','500','10000','990001','100.69','10','2022-01-16','2022-01-19'), 
 ('2022-01-19','551326','500','10000','990001','100.69','10','2022-01-19', NULL), 
 ('2022-01-12','551327','510','10012','990019','58','10','2022-01-12','2022-01-22'), 
 ('2022-01-22','551328','510','10012','990019','58','15','2022-01-22', NULL), 
 ('2022-01-09','551329','510','10012','990019','58','10','2022-01-09','2022-01-18'), 
 ('2022-01-18','551330','510','10012','990019','58','15','2022-01-18', NULL), 
 ('2022-01-10','551331','510','10012','990019','58','10','2022-01-10','2022-01-20'), 
 ('2022-01-20','551332','510','10012','990019','58','15','2022-01-20', NULL), 
 ('2022-01-11','551333','510','10012','990019','58','10','2022-01-11','2022-01-21'), 
 ('2022-01-21','551334','510','10012','990019','58','15','2022-01-21', NULL), 
 ('2022-01-12','551335','510','10012','990019','58','10','2022-01-12','2022-01-22'), 
 ('2022-01-22','551327','510','10012','990019','58','15','2022-01-22', NULL), 
 ('2022-01-07','551328','510','10012','990019','58','10','2022-01-07','2022-01-10'), 
 ('2022-01-10','551329','510','10012','990019','58','10','2022-01-10', NULL), 
 ('2022-01-10','551330','510','10012','990019','58','10','2022-01-10','2022-01-13'), 
 ('2022-01-13','551331','510','10012','990019','58','10','2022-01-13', NULL), 
 ('2022-01-13','551332','510','10012','990019','58','10','2022-01-13','2022-01-16'), 
 ('2022-01-16','551333','510','10012','990019','58','10','2022-01-16', NULL), 
 ('2022-01-16','551334','510','10012','990019','58','10','2022-01-16','2022-01-19'), 
 ('2022-01-19','551335','510','10012','990019','58','10','2022-01-19', NULL);




SELECT * FROM #dim_date
SELECT * FROM #dim_platform
SELECT * FROM #dim_product_type
SELECT * FROM #dim_status
SELECT * FROM #dim_user
SELECT * FROM #fct_listings


-- task 1
-- here I don't understand what I need to do
SELECT date_key
	   , l.*
FROM #dim_date dd
LEFT JOIN #fct_listings l ON l.Listing_date_key = dd.date_key
WHERE date_key >= '2021-12-01'
	  AND date_key < '2022-02-01'
ORDER BY Date_key


-- tsak 2
DROP TABLE #Task2
SELECT p.Platform
	   , pt.Product_type_name
	   , SUM(CONVERT(decimal(11,2), REPLACE(price, ',', ''))) AS Total
	   , RANK() OVER(PARTITION BY p.Platform ORDER BY SUM(CONVERT(decimal(11,2), REPLACE(price, ',', ''))) DESC) RN_Max
	   , RANK() OVER(PARTITION BY p.Platform ORDER BY SUM(CONVERT(decimal(11,2), REPLACE(price, ',', '')))) RN_Min
INTO #Task2
FROM #fct_listings l 
INNER JOIN #dim_platform p ON l.platform_id = p.platform_id
INNER JOIN #dim_product_type pt ON pt.product_type_id = l.product_type_id
GROUP BY p.Platform
	     , pt.Product_type_name

--SELECT * 
--FROM #Task2
--ORDER BY Platform
--	     , Total

-- 2 a
SELECT RN_Max AS RN
	   , Platform
	   , Product_type_name
	   , Total
FROM #Task2
WHERE RN_Max < 4
ORDER BY Platform
	     , RN 

-- 2 b
SELECT RN_Max AS RN
	   , Platform
	   , Product_type_name
	   , Total
FROM #Task2
WHERE RN_Max < 4
ORDER BY Platform
	     , RN_Min 

-- 2 c
DROP TABLE #task2c1
SELECT DISTINCT product_type_id
	   , date_key
INTO #task2c1
FROM #dim_product_type pt 
INNER JOIN #dim_date dd ON 1 = 1

DROP TABLE #task2c2
SELECT DISTINCT listing_date_key
	   , product_type_id
INTO #task2c2
FROM #fct_listings

DROP TABLE #task2c3
SELECT t.*
	   , listing_date_key
	   , CASE WHEN listing_date_key IS NULL THEN  1 ELSE 0 END tmp
INTO #task2c3
FROM #Task2c1 t
LEFT JOIN #task2c2 l ON l.listing_date_key = t.date_key
						AND l.product_type_id = t.product_type_id

DROP TABLE #task2c4
SELECT Product_type_name
	   , SUM(tmp) as IdleDays
	   , DENSE_RANK() OVER(ORDER BY SUM(tmp) DESC) RN
INTO #task2c4
FROM #task2c3 t
INNER JOIN #dim_product_type dpt ON dpt.product_type_id = t.product_type_id
GROUP BY Product_type_name
ORDER BY IdleDays DESC

SELECT * fROM #task2c4
WHERE RN < 4
ORDER BY RN

--SELECT * fROM #task2c4
--ORDER BY RN

-- 2 d

DROP TABLE #Task2d
SELECT pt.Product_type_name
	   , SUM(CONVERT(decimal(11,2), REPLACE(price, ',', ''))) AS Total
INTO #Task2d
FROM #fct_listings l 
INNER JOIN #dim_product_type pt ON pt.product_type_id = l.product_type_id
WHERE Status_id = 10 -- because here you want total SOLD amonut 					
GROUP BY pt.Product_type_name


SELECT Product_type_Name
	   , SUM(Total) AS [total amount sold by product type]
FROM #Task2d
GROUP BY Product_type_Name
ORDER BY SUM(Total) DESC

--2 e
-- Interesting can be to include for example how many users bought some product type, or stat by city
-- or for example we can use status of transactions...
-- here is example for status of transaction by city, we can do same this for example for product type, or for both product type and city

SELECT City
	   , Status_description
	   , Product_type_name
	   , COUNT(listing_id) AS NoOfTransactions
FROM #fct_listings l 
INNER JOIN #dim_status ds ON ds.status_id = l.status_id
INNER JOIN #dim_product_type dpt ON dpt.product_type_id = l.product_type_id
INNER JOIN #dim_user u ON u.user_id = l.user_id
GROUP BY City
	     , Status_description
		 ,  Product_type_name
ORDER BY City
	     , Status_description
		 , Product_type_name